<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Détail de la collection</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{--primary:#3a3a3a;--bg:#f3efe9;--card:#ffffff;--text:#3a3a3a;--border-color:#e0e0e0;--radius:8px;--danger:#d9534f;--success:#5cb85c;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;}
body{margin:0;padding:20px;background:var(--bg);color:var(--text);}
h1,h2,h3{margin:0 0 1em;color:var(--primary);text-transform:uppercase;letter-spacing:1px;text-align:center;}
h1{font-size:1.8em;margin-bottom:0;}
h2{font-size:1.5em;border-bottom:2px solid var(--primary);padding-bottom:.5em;margin-top:2em;}
h3{font-size:1.1em;text-align:left;border-bottom:1px solid #ccc;padding-bottom:.5em;margin-top:1.5em;}
.collection-title{color:#888;text-align:center;margin-bottom:2em;text-transform:uppercase;}
.back-link{position:fixed;top:20px;left:20px;background:var(--primary);color:#fff;padding:10px 18px;border-radius:var(--radius);text-decoration:none;font-weight:600;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px;margin-top:1em;}
.card{background:var(--card);border-radius:var(--radius);border:1px solid var(--border-color);overflow:hidden;position:relative;}
.card img{width:100%;height:220px;object-fit:cover;display:block;}
.card .info{padding:10px 12px;}
.card .caption{font-weight:600;color:var(--text);}
.card .comment{font-style:italic;color:#555;margin-top:8px;background:#f8f9fa;padding:8px;border-radius:6px;font-size:14px;border:1px solid #eee;}
.card .also-wanted{position:absolute;top:10px;right:10px;background:rgba(0,0,0,0.7);color:#fff;padding:5px 10px;border-radius:6px;font-size:12px;max-width:150px;}
.card .also-wanted strong{display:block;margin-bottom:2px;}
.card .also-wanted ul{margin:0;padding-left:15px;word-break:break-all;}
.list-section { margin-bottom: 3em; padding: 2em; background: var(--card); border: 1px solid var(--border-color); border-radius: var(--radius); }
</style>
</head>
<body>

<a class="back-link" href="/selections">← Collections</a>
<h1 class="collection-title">Collection</h1>
<h1>{{ collection_name }}</h1>

{% if results %}
    {% for list_name, picks in results.items() %}
    <div class="list-section">
        <h2>Liste : {{ list_name }}</h2>
        
        {% if picks.want %}
        <div>
            <h3>Sélection "Oui"</h3>
            <div class="grid">
                {% for item in picks.want %}
                <div class="card">
                    <img src="/{{ item.thumb }}" alt="{{ item.caption }}">
                    
                    {% if item.also_wanted_in and item.also_wanted_in|length > 0 %}
                    <div class="also-wanted">
                        <strong>Aussi dans :</strong>
                        <ul>
                        {% for other_list in item.also_wanted_in %}
                            {% if other_list != list_name %} {# N'affiche que les AUTRES listes #}
                                <li>{{ other_list }}</li>
                            {% endif %}
                        {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    
                    <div class="info">
                        <div class="caption">{{ item.caption or 'Sans légende' }}</div>
                        {% if item.comment %}
                            <div class="comment"><strong>Commentaire :</strong> {{ item.comment }}</div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if picks.dont %}
        <div>
            <h3>Sélection "Non"</h3>
            <div class="grid">
                {% for item in picks.dont %}
                <div class="card">
                    <img src="/{{ item.thumb }}" alt="{{ item.caption }}">
                    <div class="info">
                        <div class="caption">{{ item.caption or 'Sans légende' }}</div>
                        {% if item.comment %}
                            <div class="comment"><strong>Commentaire :</strong> {{ item.comment }}</div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if not picks.want and not picks.dont %}
            <p>Aucun article de cette collection n'a été voté pour cette liste.</p>
        {% endif %}
    </div>
    {% endfor %}
{% else %}
    <p style="text-align:center; margin-top:2em;">Personne n'a encore voté pour des articles de cette collection.</p>
{% endif %}

</body>
</html>
